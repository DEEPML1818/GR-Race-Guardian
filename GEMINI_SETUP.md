# ü§ñ Gemini 2.0 Flash Setup Guide

## Overview

GR Race Guardian now uses **Google Gemini 2.0 Flash** for intelligent AI responses. The system falls back to template-based responses if Gemini is not configured.

## Setup Instructions

### 1. Get Gemini API Key

1. Go to [Google AI Studio](https://makersuite.google.com/app/apikey)
2. Sign in with your Google account
3. Click "Create API Key"
4. Copy your API key

### 2. Configure Environment Variable

**Option 1: Environment File (Recommended)**

Create a `.env` file in the `backend-node` directory:

```bash
GEMINI_API_KEY=your_api_key_here
```

**Option 2: System Environment Variable**

Windows (PowerShell):
```powershell
$env:GEMINI_API_KEY="your_api_key_here"
```

Windows (CMD):
```cmd
set GEMINI_API_KEY=your_api_key_here
```

Linux/Mac:
```bash
export GEMINI_API_KEY=your_api_key_here
```

### 3. Install Gemini Package

The package is already in `package.json`. Just run:

```bash
cd backend-node
npm install
```

This will install `@google/generative-ai`.

### 4. Verify Setup

Start the Node.js server:

```bash
cd backend-node
node server.js
```

You should see:
```
[Gemini] AI service initialized successfully
[AI] Gemini 2.0 Flash enabled for intelligent responses
```

If you see:
```
[Gemini] GEMINI_API_KEY not set. AI will use template-based responses.
```

Then Gemini is not configured, but the system will still work with template-based responses.

## How It Works

### With Gemini Enabled

- AI responses are generated by Gemini 2.0 Flash
- More intelligent, contextual analysis
- Better understanding of user queries
- Professional motorsport terminology
- Data-driven insights

### Without Gemini (Fallback)

- Uses comprehensive template-based responses
- All 7 modes still work
- Professional analysis based on data
- No API key required

## API Usage

### With User Query (Gemini Powered)

```javascript
POST /api/ai/analyze
{
  "mode": "engineering",
  "user_query": "Should we pit now?",
  "driver_twin": {...},
  "race_twin": {...}
}
```

### Without User Query (Template Based)

```javascript
POST /api/ai/analyze
{
  "mode": "engineering",
  "driver_twin": {...},
  "race_twin": {...}
}
```

## Modes Supported

All 7 modes work with both Gemini and templates:

1. **Engineering** - Professional race engineer analysis
2. **Strategy** - Tactical strategy recommendations
3. **Coach** - Driver improvement analysis
4. **Fan** - Exciting race commentary
5. **Summary** - Race recap
6. **Compare** - Driver comparison
7. **Pit Decision** - Pit stop recommendations

## Troubleshooting

### Gemini Not Working

1. Check API key is set: `echo $GEMINI_API_KEY` (or `echo %GEMINI_API_KEY%` on Windows)
2. Verify package installed: `npm list @google/generative-ai`
3. Check server logs for error messages
4. System will automatically fall back to templates

### Rate Limits

Gemini has rate limits. If you hit them:
- System automatically falls back to templates
- No errors, seamless transition
- Check your API quota at Google AI Studio

## Cost

Gemini 2.0 Flash is **free** for reasonable usage. Check [Google's pricing](https://ai.google.dev/pricing) for details.

## Security

‚ö†Ô∏è **Never commit your API key to git!**

- Add `.env` to `.gitignore`
- Use environment variables in production
- Rotate keys if exposed

